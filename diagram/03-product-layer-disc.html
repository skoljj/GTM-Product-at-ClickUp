<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Module 3 — Product Layer Disc</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#020408;overflow:hidden;font-family:'SF Pro Display',system-ui,-apple-system,sans-serif;color:#c8d6e5}
canvas{position:fixed;top:0;left:0;z-index:0}
#hud{position:fixed;top:16px;left:16px;z-index:100;pointer-events:none}
#hud h1{font-size:11px;color:#c77dff;font-weight:300;letter-spacing:.15em;text-transform:uppercase;opacity:.9}
#hud .sub{font-size:9px;color:#445566;margin-top:3px;letter-spacing:.08em}
#hud .title{font-size:28px;font-weight:200;letter-spacing:.04em;margin-top:8px;color:#c77dff}
#hint{position:fixed;bottom:24px;left:50%;transform:translateX(-50%);z-index:100;font-size:9px;letter-spacing:.15em;text-transform:uppercase;color:rgba(100,130,160,.5);pointer-events:none;transition:opacity .8s}
#back{position:fixed;bottom:24px;right:24px;z-index:100;background:rgba(8,12,24,.85);border:1px solid rgba(199,125,255,.2);color:#c77dff;padding:6px 14px;border-radius:3px;cursor:pointer;font-size:9px;letter-spacing:.1em;text-transform:uppercase;text-decoration:none;backdrop-filter:blur(8px)}
#back:hover{border-color:rgba(199,125,255,.5)}
</style>
</head>
<body>
<div id="hud">
  <h1>Capability Architecture · Module 3</h1>
  <div class="sub">Drag to orbit · Scroll to zoom</div>
  <div class="title">PRODUCT LAYER DISC</div>
</div>
<div id="hint">DRAG TO ORBIT 360° · SCROLL TO ZOOM</div>
<a id="back" href="../product_design_concept1.html">← Full Diagram</a>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
const scene=new THREE.Scene();
scene.fog=new THREE.FogExp2(0x020408,0.0005);
const camera=new THREE.PerspectiveCamera(50,innerWidth/innerHeight,0.1,2500);
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
renderer.setPixelRatio(Math.min(devicePixelRatio,2));
renderer.toneMapping=THREE.ACESFilmicToneMapping;
renderer.toneMappingExposure=1.15;
document.body.appendChild(renderer.domElement);

let drag=false,pM={x:0,y:0};
let sph={theta:0.5,phi:1.0,r:65};
const lookTarget=new THREE.Vector3(0,0,0);
function camUp(){
  camera.position.x=lookTarget.x+sph.r*Math.sin(sph.phi)*Math.sin(sph.theta);
  camera.position.y=lookTarget.y+sph.r*Math.cos(sph.phi);
  camera.position.z=lookTarget.z+sph.r*Math.sin(sph.phi)*Math.cos(sph.theta);
  camera.lookAt(lookTarget);
}
camUp();
renderer.domElement.addEventListener('pointerdown',e=>{drag=true;pM={x:e.clientX,y:e.clientY}});
renderer.domElement.addEventListener('pointermove',e=>{if(!drag)return;sph.theta-=(e.clientX-pM.x)*0.005;sph.phi=Math.max(0.1,Math.min(2.9,sph.phi+(e.clientY-pM.y)*0.005));pM={x:e.clientX,y:e.clientY};camUp()});
renderer.domElement.addEventListener('pointerup',()=>drag=false);
renderer.domElement.addEventListener('pointerleave',()=>drag=false);
renderer.domElement.addEventListener('wheel',e=>{e.preventDefault();sph.r=Math.max(25,Math.min(150,sph.r+e.deltaY*0.1));camUp()},{passive:false});

scene.add(new THREE.AmbientLight(0x223344,0.5));
[[0xc77dff,2.5,[0,15,0]],[0x10a37f,1.5,[0,12,20]],[0x7B68EE,1.5,[0,-12,20]],[0x00e5ff,1.2,[20,0,0]]]
.forEach(([c,i,p])=>{const pl=new THREE.PointLight(c,i,200);pl.position.set(...p);scene.add(pl)});

const starGeo=new THREE.BufferGeometry();const sP=new Float32Array(4000*3);
for(let i=0;i<4000;i++){const r=300+Math.random()*600,th=Math.random()*Math.PI*2,ph=Math.acos(2*Math.random()-1);
sP[i*3]=r*Math.sin(ph)*Math.cos(th);sP[i*3+1]=r*Math.sin(ph)*Math.sin(th);sP[i*3+2]=r*Math.cos(ph)}
starGeo.setAttribute('position',new THREE.BufferAttribute(sP,3));
scene.add(new THREE.Points(starGeo,new THREE.PointsMaterial({color:0x5577aa,size:0.3,transparent:true,opacity:0.4})));

// ═══ PRODUCT LAYER DISC ═══
const DISC_R=38,DISC_TOTAL_H=24,PROD_Y=0;
const FLOOR_Y=PROD_Y-DISC_TOTAL_H/2,CEIL_Y=PROD_Y+DISC_TOTAL_H/2;
const DISC_THICK=0.6;
const MCP_ZONE_H=7,API_ZONE_H=7;
const CORE_BOT=FLOOR_Y+DISC_THICK+MCP_ZONE_H;
const CORE_TOP=CEIL_Y-DISC_THICK-API_ZONE_H;
const CORE_H=CORE_TOP-CORE_BOT;

// Shell
scene.add(new THREE.Mesh(new THREE.CylinderGeometry(DISC_R,DISC_R,DISC_TOTAL_H,64,1,true),new THREE.MeshPhysicalMaterial({color:0x0c0820,metalness:0.92,roughness:0.08,transparent:true,opacity:0.08,side:THREE.DoubleSide})));
scene.children[scene.children.length-1].position.set(0,PROD_Y,0);

// Edge rings
function circleRing(y,color,op){const pts=[];for(let j=0;j<=128;j++){const a=(j/128)*Math.PI*2;pts.push(new THREE.Vector3(Math.cos(a)*DISC_R,y,Math.sin(a)*DISC_R))}
scene.add(new THREE.Line(new THREE.BufferGeometry().setFromPoints(pts),new THREE.LineBasicMaterial({color,transparent:true,opacity:op})))}
circleRing(FLOOR_Y,0x7B68EE,0.5);circleRing(CEIL_Y,0x10a37f,0.5);
circleRing(CORE_BOT,0xc77dff,0.35);circleRing(CORE_TOP,0xc77dff,0.35);
circleRing(PROD_Y,0xc77dff,0.15);

// Floor + Ceiling
scene.add((()=>{const m=new THREE.Mesh(new THREE.CylinderGeometry(DISC_R,DISC_R,DISC_THICK,64),new THREE.MeshPhysicalMaterial({color:0x0c0820,metalness:0.92,roughness:0.08,clearcoat:0.8,transparent:true,opacity:0.35}));m.position.set(0,FLOOR_Y+DISC_THICK/2,0);return m})());
scene.add((()=>{const m=new THREE.Mesh(new THREE.CylinderGeometry(DISC_R,DISC_R,DISC_THICK,64),new THREE.MeshPhysicalMaterial({color:0x0c0820,metalness:0.92,roughness:0.08,clearcoat:0.8,transparent:true,opacity:0.35}));m.position.set(0,CEIL_Y-DISC_THICK/2,0);return m})());

// Section glow
[CORE_BOT,CORE_TOP].forEach(y=>{
  const r2=new THREE.Mesh(new THREE.RingGeometry(DISC_R-2,DISC_R,64),new THREE.MeshBasicMaterial({color:0xc77dff,transparent:true,opacity:0.03,side:THREE.DoubleSide}));
  r2.rotation.x=-Math.PI/2;r2.position.y=y;scene.add(r2);
});

// Zone labels
function discLabel(text,sub,y,color){
  const c=document.createElement('canvas');c.width=512;c.height=80;const ctx=c.getContext('2d');
  ctx.font='bold 32px monospace';ctx.fillStyle=color;ctx.globalAlpha=0.7;ctx.textAlign='center';ctx.fillText(text,256,38);
  if(sub){ctx.font='400 16px monospace';ctx.globalAlpha=0.4;ctx.fillText(sub,256,62)}
  const s=new THREE.Sprite(new THREE.SpriteMaterial({map:new THREE.CanvasTexture(c),transparent:true}));
  s.position.set(0,y,DISC_R+8);s.scale.set(22,3.5,1);scene.add(s);
}
discLabel('API LAYER','LLM Partners · Ceiling Zone',CEIL_Y-API_ZONE_H/2,'#10a37f');
discLabel('CODEBASE','Studio · Lab · Core Ring',(CORE_BOT+CORE_TOP)/2,'#c77dff');
discLabel('MCP LAYER','Model Context Protocol · Floor Zone',FLOOR_Y+MCP_ZONE_H/2,'#7B68EE');

// Main label
(()=>{const c=document.createElement('canvas');c.width=512;c.height=64;const x=c.getContext('2d');
x.font='bold 28px monospace';x.fillStyle='#c77dff';x.globalAlpha=0.6;x.textAlign='center';x.fillText('PRODUCT LAYER',256,32);
x.font='400 16px monospace';x.globalAlpha=0.3;x.fillText('Enablement as Product Discipline',256,54);
const s=new THREE.Sprite(new THREE.SpriteMaterial({map:new THREE.CanvasTexture(c),transparent:true}));
s.position.set(0,CEIL_Y+5,0);s.scale.set(28,3.5,1);scene.add(s)})();

// Interior particles
const fpColors=[new THREE.Color(0x00e5ff),new THREE.Color(0xc77dff),new THREE.Color(0x00e5a0),new THREE.Color(0x6366f1),new THREE.Color(0xf4a623),new THREE.Color(0xe63946)];
const prodPN=600;const prodPGeo=new THREE.BufferGeometry();const prodPPos=new Float32Array(prodPN*3);const prodPCol=new Float32Array(prodPN*3);
for(let i=0;i<prodPN;i++){const a=Math.random()*Math.PI*2,r=Math.random()*DISC_R*0.7;
prodPPos[i*3]=Math.cos(a)*r;prodPPos[i*3+1]=FLOOR_Y+DISC_THICK+Math.random()*(DISC_TOTAL_H-2*DISC_THICK);prodPPos[i*3+2]=Math.sin(a)*r;
const c=fpColors[Math.floor(Math.random()*fpColors.length)];prodPCol[i*3]=c.r;prodPCol[i*3+1]=c.g;prodPCol[i*3+2]=c.b}
prodPGeo.setAttribute('position',new THREE.BufferAttribute(prodPPos,3));prodPGeo.setAttribute('color',new THREE.BufferAttribute(prodPCol,3));
const prodParticles=new THREE.Points(prodPGeo,new THREE.PointsMaterial({size:0.12,vertexColors:true,transparent:true,opacity:0.5,blending:THREE.AdditiveBlending}));scene.add(prodParticles);

// Core glow
const prodCore=new THREE.Mesh(new THREE.CylinderGeometry(3,3,CORE_H+1,32),new THREE.MeshBasicMaterial({color:0xc77dff,transparent:true,opacity:0.04}));prodCore.position.set(0,(CORE_BOT+CORE_TOP)/2,0);scene.add(prodCore);
const prodGlow=new THREE.Mesh(new THREE.SphereGeometry(6,16,16),new THREE.MeshBasicMaterial({color:0xc77dff,transparent:true,opacity:0.02}));prodGlow.position.set(0,(CORE_BOT+CORE_TOP)/2,0);scene.add(prodGlow);
const prodGrid=new THREE.GridHelper(DISC_R*1.4,40,0x1a0e30,0x0e0820);prodGrid.position.y=FLOOR_Y+DISC_THICK+0.01;scene.add(prodGrid);

// ═══ ANIMATE ═══
const clock=new THREE.Clock();
function animate(){
  requestAnimationFrame(animate);const t=clock.getElapsedTime();
  const pp=prodParticles.geometry.attributes.position.array;
  for(let i=0;i<prodPN;i++){const ox=pp[i*3],oz=pp[i*3+2];const cs=Math.cos(0.0012),sn=Math.sin(0.0012);
  pp[i*3]=ox*cs-oz*sn;pp[i*3+2]=ox*sn+oz*cs;
  pp[i*3+1]=FLOOR_Y+DISC_THICK+1+Math.abs(Math.sin(t*0.25+i*0.005))*(DISC_TOTAL_H-2*DISC_THICK-2)}
  prodParticles.geometry.attributes.position.needsUpdate=true;
  const pcs=1+0.08*Math.sin(t*0.8);prodCore.scale.set(pcs,1,pcs);prodCore.material.opacity=0.03+0.03*Math.sin(t*1.2);
  prodGlow.scale.set(pcs*1.3,pcs*1.3,pcs*1.3);
  renderer.render(scene,camera);
}
animate();
window.addEventListener('resize',()=>{camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight)});
setTimeout(()=>{document.getElementById('hint').style.opacity='0'},5000);
</script>
</body>
</html>
