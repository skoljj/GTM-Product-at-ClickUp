<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Module 6 — MCP Gears</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#020408;overflow:hidden;font-family:'SF Pro Display',system-ui,-apple-system,sans-serif;color:#c8d6e5}
canvas{position:fixed;top:0;left:0;z-index:0}
#hud{position:fixed;top:16px;left:16px;z-index:100;pointer-events:none}
#hud h1{font-size:11px;color:#7B68EE;font-weight:300;letter-spacing:.15em;text-transform:uppercase;opacity:.9}
#hud .sub{font-size:9px;color:#445566;margin-top:3px;letter-spacing:.08em}
#hud .title{font-size:28px;font-weight:200;letter-spacing:.04em;margin-top:8px;color:#7B68EE}
#hint{position:fixed;bottom:24px;left:50%;transform:translateX(-50%);z-index:100;font-size:9px;letter-spacing:.15em;text-transform:uppercase;color:rgba(100,130,160,.5);pointer-events:none;transition:opacity .8s}
#back{position:fixed;bottom:24px;right:24px;z-index:100;background:rgba(8,12,24,.85);border:1px solid rgba(123,104,238,.2);color:#7B68EE;padding:6px 14px;border-radius:3px;cursor:pointer;font-size:9px;letter-spacing:.1em;text-transform:uppercase;text-decoration:none;backdrop-filter:blur(8px)}
#back:hover{border-color:rgba(123,104,238,.5)}
</style>
</head>
<body>
<div id="hud">
  <h1>Capability Architecture · Module 6</h1>
  <div class="sub">Drag to orbit · Scroll to zoom</div>
  <div class="title">MCP GEARS</div>
</div>
<div id="hint">DRAG TO ORBIT 360° · SCROLL TO ZOOM</div>
<a id="back" href="../product_design_concept1.html">← Full Diagram</a>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
const scene=new THREE.Scene();
scene.fog=new THREE.FogExp2(0x020408,0.0008);
const camera=new THREE.PerspectiveCamera(50,innerWidth/innerHeight,0.1,2500);
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
renderer.setPixelRatio(Math.min(devicePixelRatio,2));
renderer.toneMapping=THREE.ACESFilmicToneMapping;
renderer.toneMappingExposure=1.15;
document.body.appendChild(renderer.domElement);

let drag=false,pM={x:0,y:0};
let sph={theta:0.5,phi:0.85,r:40};
const lookTarget=new THREE.Vector3(0,3,0);
function camUp(){
  camera.position.x=lookTarget.x+sph.r*Math.sin(sph.phi)*Math.sin(sph.theta);
  camera.position.y=lookTarget.y+sph.r*Math.cos(sph.phi);
  camera.position.z=lookTarget.z+sph.r*Math.sin(sph.phi)*Math.cos(sph.theta);
  camera.lookAt(lookTarget);
}
camUp();
renderer.domElement.addEventListener('pointerdown',e=>{drag=true;pM={x:e.clientX,y:e.clientY}});
renderer.domElement.addEventListener('pointermove',e=>{if(!drag)return;sph.theta-=(e.clientX-pM.x)*0.005;sph.phi=Math.max(0.1,Math.min(2.9,sph.phi+(e.clientY-pM.y)*0.005));pM={x:e.clientX,y:e.clientY};camUp()});
renderer.domElement.addEventListener('pointerup',()=>drag=false);
renderer.domElement.addEventListener('pointerleave',()=>drag=false);
renderer.domElement.addEventListener('wheel',e=>{e.preventDefault();sph.r=Math.max(15,Math.min(100,sph.r+e.deltaY*0.08));camUp()},{passive:false});

scene.add(new THREE.AmbientLight(0x223344,0.5));
[[0x7B68EE,2.5,[0,10,0]],[0x00A1E0,1.5,[10,2,10]],[0x6FBF73,1.2,[-10,2,-10]],[0xF24E1E,0.8,[15,5,0]]]
.forEach(([c,i,p])=>{const pl=new THREE.PointLight(c,i,120);pl.position.set(...p);scene.add(pl)});

const starGeo=new THREE.BufferGeometry();const sP=new Float32Array(3000*3);
for(let i=0;i<3000;i++){const r=150+Math.random()*400,th=Math.random()*Math.PI*2,ph=Math.acos(2*Math.random()-1);
sP[i*3]=r*Math.sin(ph)*Math.cos(th);sP[i*3+1]=r*Math.sin(ph)*Math.sin(th);sP[i*3+2]=r*Math.cos(ph)}
starGeo.setAttribute('position',new THREE.BufferAttribute(sP,3));
scene.add(new THREE.Points(starGeo,new THREE.PointsMaterial({color:0x5577aa,size:0.3,transparent:true,opacity:0.4})));

// ═══ MCP GEARS ═══
const MCP_ITEMS=[
  {name:'ClickUp',color:0x7B68EE,subtext:'Native · MCP · API',sym:'▦'},
  {name:'Salesforce',color:0x00A1E0,sym:'☁'},
  {name:'Gong',color:0x6FBF73,sym:'◉'},
  {name:'Figma',color:0xF24E1E,sym:'◈'}
];
const GEAR_IR=4,GEAR_OR=10,GEAR_TEETH=24,GEAR_TOOTH_H=1.8,GEAR_THICK=1.4,GEAR_GAP=0.4;
const gearBaseY=0;

function createGearMesh(innerR,outerR,teeth,toothH,thick,color){
  const g=new THREE.Group();
  const dg=new THREE.CylinderGeometry(outerR,outerR,thick,48);
  g.add(new THREE.Mesh(dg,new THREE.MeshPhysicalMaterial({color,metalness:0.85,roughness:0.15,transparent:true,opacity:0.22})));
  g.add(new THREE.LineSegments(new THREE.EdgesGeometry(dg),new THREE.LineBasicMaterial({color,transparent:true,opacity:0.35})));
  for(let i=0;i<teeth;i++){const a=(i/teeth)*Math.PI*2;const tG=new THREE.BoxGeometry(1.2,thick*0.8,toothH);
    const tooth=new THREE.Mesh(tG,new THREE.MeshPhysicalMaterial({color,metalness:0.8,roughness:0.2,transparent:true,opacity:0.3}));
    tooth.position.set(Math.cos(a)*(outerR+toothH/2),0,Math.sin(a)*(outerR+toothH/2));tooth.rotation.y=-a;g.add(tooth);
    g.add((()=>{const m=new THREE.LineSegments(new THREE.EdgesGeometry(tG),new THREE.LineBasicMaterial({color,transparent:true,opacity:0.25}));m.position.copy(tooth.position);m.rotation.copy(tooth.rotation);return m})())}
  const hr=new THREE.Mesh(new THREE.RingGeometry(innerR-0.3,innerR+0.3,32),new THREE.MeshBasicMaterial({color,transparent:true,opacity:0.15,side:THREE.DoubleSide}));hr.rotation.x=-Math.PI/2;g.add(hr);
  for(let r=innerR+1.5;r<outerR;r+=2){const ring=new THREE.Mesh(new THREE.RingGeometry(r-0.05,r+0.05,48),new THREE.MeshBasicMaterial({color,transparent:true,opacity:0.06,side:THREE.DoubleSide}));ring.rotation.x=-Math.PI/2;ring.position.y=thick/2+0.02;g.add(ring)}
  scene.add(g);return g;
}

const allGears=[];
MCP_ITEMS.forEach((mcp,i)=>{
  const y=gearBaseY+i*(GEAR_THICK+GEAR_GAP);
  const gear=createGearMesh(GEAR_IR,GEAR_OR,GEAR_TEETH,GEAR_TOOTH_H,GEAR_THICK,mcp.color);
  gear.position.set(0,y,0);gear.userData={speed:(0.008+i*0.003)*(i%2===0?1:-1),baseY:y};
  const lC=document.createElement('canvas');lC.width=512;lC.height=64;const lX=lC.getContext('2d');
  lX.font='bold 36px monospace';lX.fillStyle='#'+mcp.color.toString(16).padStart(6,'0');lX.globalAlpha=0.9;lX.textAlign='left';lX.fillText(mcp.sym+' ',20,32);
  lX.font='bold 22px monospace';lX.globalAlpha=0.8;lX.fillText(mcp.name.toUpperCase(),70,30);
  if(mcp.subtext){lX.font='400 15px monospace';lX.globalAlpha=0.4;lX.fillText(mcp.subtext,70,52)}
  const lS=new THREE.Sprite(new THREE.SpriteMaterial({map:new THREE.CanvasTexture(lC),transparent:true}));
  lS.position.set(GEAR_OR+GEAR_TOOTH_H+7,y,0);lS.scale.set(16,2.5,1);scene.add(lS);allGears.push(gear);
});

// MCP label
(()=>{const c=document.createElement('canvas');c.width=512;c.height=64;const x=c.getContext('2d');
x.font='bold 26px monospace';x.fillStyle='#7B68EE';x.globalAlpha=0.5;x.textAlign='center';x.fillText('MCP CONNECTIONS',256,30);
x.font='400 14px monospace';x.globalAlpha=0.3;x.fillText('Model Context Protocol · Floor',256,52);
const s=new THREE.Sprite(new THREE.SpriteMaterial({map:new THREE.CanvasTexture(c),transparent:true}));
s.position.set(-(GEAR_OR+10),gearBaseY+(MCP_ITEMS.length-1)*(GEAR_THICK+GEAR_GAP)/2,0);s.scale.set(18,2.8,1);scene.add(s)})();

// Floor grid
const floorGrid=new THREE.GridHelper(40,30,0x1a0e30,0x0e0820);floorGrid.position.y=-2;scene.add(floorGrid);

// ═══ ANIMATE ═══
const clock=new THREE.Clock();
function animate(){
  requestAnimationFrame(animate);const t=clock.getElapsedTime();
  allGears.forEach(gear=>{gear.rotation.y+=gear.userData.speed});
  renderer.render(scene,camera);
}
animate();
window.addEventListener('resize',()=>{camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight)});
setTimeout(()=>{document.getElementById('hint').style.opacity='0'},5000);
</script>
</body>
</html>
